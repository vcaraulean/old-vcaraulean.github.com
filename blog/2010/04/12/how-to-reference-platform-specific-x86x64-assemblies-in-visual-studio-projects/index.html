
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>How to reference platform specific (x86/x64) assemblies in Visual Studio projects - valeriu caraulean</title>
  <meta name="author" content="Valeriu Caraulean">

  
  <meta name="description" content="Let’s say you have a third party library that you want to reference from your project. By default platform target in Visual Studio is &#8221;Any &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://caraulean.com/blog/2010/04/12/how-to-reference-platform-specific-x86x64-assemblies-in-visual-studio-projects/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="valeriu caraulean" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-21974825-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1>
    <a href="/">
      <div id="logoLeft">{</div>
      <div id="logoText"> blog </div>
      <div id="logoRight">}</div>
      <div>valeriu caraulean</div>
      <div class="clear"></div>
    </a>
  </h1>
  
    <h2>keep it simple, it will work...</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:caraulean.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">How to Reference Platform Specific (X86/x64) Assemblies in Visual Studio Projects</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-04-12T16:04:24+02:00" pubdate data-updated="true">Apr 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Let’s say you have a third party library that you want to reference from your project. By default platform target in Visual Studio is &#8221;<strong>Any CPU</strong>&#8221;. But the library is compiled for specific target – <strong>x86</strong> or <strong>x64</strong>. When you’re working in a team, have a build server and all of them is in different platforms you’ll start to have issues. Like, project with an x64 referenced assembly working ok on your x64 machine and failing on x86 computers and so on.</p>

<p>For us it was the “<strong>System.Data.SQLite</strong>” – the <a href="http://sqlite.phxsoftware.com/">ADO.NET provider for SQLite</a>. It is provided compiled separately for 32 and 64 bit systems. It was not easy to figure out how to manage references to SQLite provider without making too much changes in our projects and build scripts.</p>

<p>I’ve found an elegant solution for it: manually modifying project files that are using it to add a conditional elements to <Project> node. Look at this code:</p>

<pre><code>  &lt;Choose&gt;
    &lt;When Condition="$(PROCESSOR_ARCHITECTURE) == 'AMD64' Or $(PROCESSOR_ARCHITEW6432) == 'AMD64'"&gt;
      &lt;ItemGroup&gt;
        &lt;Reference Include="System.Data.SQLite, Version=1.0.65.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139, processorArchitecture=AMD64"&gt;
          &lt;SpecificVersion&gt;False&lt;/SpecificVersion&gt;
          &lt;HintPath&gt;..\Lib\x64\System.Data.SQLite.DLL&lt;/HintPath&gt;
        &lt;/Reference&gt;
      &lt;/ItemGroup&gt;
    &lt;/When&gt;
    &lt;Otherwise&gt;
      &lt;ItemGroup&gt;
        &lt;Reference Include="System.Data.SQLite, Version=1.0.65.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139, processorArchitecture=x86"&gt;
          &lt;SpecificVersion&gt;False&lt;/SpecificVersion&gt;
          &lt;HintPath&gt;..\Lib\x86\System.Data.SQLite.DLL&lt;/HintPath&gt;
        &lt;/Reference&gt;
      &lt;/ItemGroup&gt;
    &lt;/Otherwise&gt;
  &lt;/Choose&gt;
</code></pre>

<p><code>&lt;Choose&gt; &lt;When Condition= … /&gt; &lt;Otherwise … /&gt; &lt;/Choose&gt;</code> – it’s fun how people are trying to add “behavior” to a such static thing as XML. Well, it works, sometimes…</p>

<p>Detection of the current platform is based on checking of two environment variables: PROCESSOR_ARCHITECTURE and PROCESSOR_ARCHITEW6432 to detect “bitness” of running OS/processes. Details of this you can find in the post of David Wang <a href="http://blogs.msdn.com/david.wang/archive/2006/03/26/HOWTO-Detect-Process-Bitness.aspx">HOWTO: Detect Process Bitness</a>.</p>

<p>Working like a charm for us.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Valeriu Caraulean</span></span>

      








  


<time datetime="2010-04-12T16:04:24+02:00" pubdate data-updated="true">Apr 12<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/development/'>development</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://caraulean.com/blog/2010/04/12/how-to-reference-platform-specific-x86x64-assemblies-in-visual-studio-projects/" data-via="vcaraulean" data-counturl="http://caraulean.com/blog/2010/04/12/how-to-reference-platform-specific-x86x64-assemblies-in-visual-studio-projects/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/2010/03/15/all-is-starting-with-a-cv/" title="Previous Post: All is starting with a CV">&laquo; All is starting with a CV</a>
      
      
        <a class="basic-alignment right articlenav" href="/blog/2010/04/14/microsoft-techdays-2010-geneva-day-1/" title="Next Post: Microsoft TechDays 2010, Geneva. Day 1">Microsoft TechDays 2010, Geneva. Day 1 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
	<h1>About</h1>
	<p>I'm a passionate software developer living in Geneva, Switzerland</p>
	<p><a href="/about">Read more ...</a></p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/14/book-review-nosql-distilled/">Book review - NoSQL Distilled</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/15/do-less-and-achieve-more-with-ravendb/">Do less and achieve more with RavenDb</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/09/diving-deeper-in-reactive-extensions/">Diving deeper in Reactive Extensions, concurrency</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/30/hello/">Hello, new blog!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/30/visual-studio-2012-dark-theme-tip/">Visual Studio 2012 dark theme tip - light up your UserControl in XAML designer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/28/evening-time-time-for-fun/">Evening time, time for fun</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/21/on-motivation-a-quote/">On motivation, a quote...</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/19/migrating-from-silverlight-to-wpf-a-case-study/">Migrating from Silverlight to WPF, a case study</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/18/fearing-about-silverlights-future-dont/">Fearing about Silverlight's future? Don't...</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/02/packed-for-vacation/">Packed for vacation...</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("vcaraulean", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/vcaraulean" class="twitter-follow-button" data-show-count="false">Follow @vcaraulean</a>
  
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/108353347632139121774?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Valeriu Caraulean -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'caraulean';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://caraulean.com/blog/2010/04/12/how-to-reference-platform-specific-x86x64-assemblies-in-visual-studio-projects/';
        var disqus_url = 'http://caraulean.com/blog/2010/04/12/how-to-reference-platform-specific-x86x64-assemblies-in-visual-studio-projects/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
