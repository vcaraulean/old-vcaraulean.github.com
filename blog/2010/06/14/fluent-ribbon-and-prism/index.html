
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Fluent Ribbon and Prism - valeriu caraulean</title>
	<meta name="author" content="Valeriu Caraulean">

	
	<meta name="description" content="Fluent Ribbon and Prism I would like to show an example of application that is about how to use Fluent Ribbon control together with Prism (aka &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="valeriu caraulean" type="application/atom+xml">
	
	<link rel="canonical" href="http://caraulean.com/blog/2010/06/14/fluent-ribbon-and-prism/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><!-- Don't want the pic in header

<div class="profilepic">
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
</div>

-->

<hgroup>
  <h1>
    <a href="/"> valeriu caraulean</a>
  </h1>
</hgroup>

<p class="subtitle">keep it simple, it will work...</p>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/vcaraulean" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/vcaraulean" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Fluent Ribbon and Prism</h1>
	<div class="entry-content" itemprop="articleBody"><p>I would like to show an example of application that is about how to use <a href="http://fluent.codeplex.com">Fluent Ribbon</a> control together with <a href="http://compositewpf.codeplex.com">Prism (aka Composite WPF)</a>. Our team is using this combination for some time already; although, with various degrees of success: the Fluent Ribbon is not enough mature (but pretty stable) and my personal relation with Prism is kind of love/hate. The <a href="http://www.castleproject.org/container/">Castle Winsor</a> is starring as IoC Container of choice.</p>

<p>The code is not something extraordinary by any means. You can find lots of similar samples for other controls in the net. It’s just a sample how to use these libraries together.</p>

<p>In this example I’ve set next scenario: a module (or another part of application) wants to add new <strong>RibbonTabItem</strong> to existing <strong>Ribbon</strong> without having a direct reference to it. Also, application should support activation/deactivation and removing of Tabs.</p>

<p>The basics are pretty straightforward: pick/write an IRegion, write an adapter to work as a mediator between it and control being extended, profit!..</p>

<p>I’ve decided to use an existing Region to serve as host for tabs - <strong>SingleActiveRegion</strong>. It seems to fit well expected behavior.</p>

<p>Two classes that I wrote are <strong><a href="http://github.com/vcaraulean/FluentRibbonAndPrism/blob/master/FluentRibbonAndPrism/Infrastructure/RibbonRegionAdapter.cs">RibbonRegionAdapter</a></strong> and <strong><a href="http://github.com/vcaraulean/FluentRibbonAndPrism/blob/master/FluentRibbonAndPrism/Infrastructure/RibbonRegionSyncBehavior.cs">RibbonRegionSyncBehavior</a></strong>. The behavior class is used to synchronize the Tabs collection of the Ribbon with Views and ActiveViews collections of the SingleActiveRegion. Adapter serves only to instantiate the region and attach the behavior.</p>

<p>Also, this solution uses Castle Windsor to wire up all things. The <strong>WindsorBootstrapper</strong> class wires up an application based on Prism v2.2 and Castle.</p>

<p>I’ll not publish the the code here, you can &#8220;git clone &#8230;&#8221; it from <a href="http://github.com/vcaraulean/FluentRibbonAndPrism">repository on GitHub</a>. Or, from the same place, you have the option to <a href="http://github.com/vcaraulean/FluentRibbonAndPrism/archives/master">download sources</a>.</p>

<p>Future plans include few more regions (Backstage, RibbonTabItem) and may be some tests.</p>

<p>Solution specifics:</p>

<ul>
<li>Prism v2.2</li>
<li>Fluent Ribbon rev. 51299</li>
<li>Castle Windsor 2.1.1</li>
<li>VS 2010 &amp; NET 4.0</li>
</ul>


<p>Disclaimer: code is provided “AS IS”. It may contain bugs and not be written in best possible way. I’m not a Prism specialist by any means. Any help is welcome if somebody can improve this code or wants to contribute for a more meaningful example&#8230;</p>
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - Valeriu Caraulean -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'caraulean';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://caraulean.com/blog/2010/06/14/fluent-ribbon-and-prism/';
        var disqus_url = 'http://caraulean.com/blog/2010/06/14/fluent-ribbon-and-prism/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-21974825-3']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




		</div>
	</div>
</body>
</html>
