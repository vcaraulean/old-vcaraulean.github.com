
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Handling Mouse Double Click event in Silverlight with Caliburn.Micro - valeriu caraulean</title>
  <meta name="author" content="Valeriu Caraulean">

  
  <meta name="description" content="There are times when you want to handle a “MouseDoubleClick” event in your code and execute something in your ViewModel as a response to the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://caraulean.com/blog/2010/11/18/handling-mouse-double-click-event-in-silverlight-with-caliburn-micro/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="valeriu caraulean" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-21974825-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1>
    <a href="/">
      <div id="logoLeft">{</div>
      <div id="logoText"> blog </div>
      <div id="logoRight">}</div>
      <div>valeriu caraulean</div>
      <div class="clear"></div>
    </a>
  </h1>
  
    <h2>keep it simple, it will work...</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:caraulean.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Handling Mouse Double Click Event in Silverlight With Caliburn.Micro</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2010-11-18T12:32:03+01:00" pubdate data-updated="true">Nov 18<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>There are times when you want to handle a “MouseDoubleClick” event in your code and execute something in your ViewModel as a response to the event . Back in the day, I’ve done few implementations of mechanism that will allow do this, for both WPF and Silverlight platforms, with different degrees of success and (developer) satisfaction. The one I’ll be talking is, so far, the prettiest and I like how it works. Mostly because of using <a href="http://caliburnmicro.codeplex.com/wikipage?title=All%20About%20Actions&amp;referringTitle=Documentation">Actions from Caliburn.Micro</a> framework. The Actions mechanics gives a very neat way to execute logic in VM’s as a response to UI events. A typical example for declaring an action will be:</p>

<pre><code>&lt;Button Content="Remove"
        cal:Message.Attach="[Event Click] = [Action Remove($dataContext)]" /&gt;
</code></pre>

<p>Back to the Mouse Double Click or, better said, to lack of such event in Silverlight.</p>

<p>Most of implementations you’ll find in internet will play with catching sequential clicks or “MouseLeftButtonUp” events and then deciding, it was a double click or not (using TimeSpan and distance between clicks, <a href="http://www.michaelsnow.com/2010/05/10/silverlight-tip-of-the-day-17-double-click/">sample implementation</a>). The interesting bit however was to link this event to an Action to be executed by Caliburn.Micro on your ViewModel and reuse that for any visual elements.</p>

<p>First, I’ve set the API how I want to see it:</p>

<pre><code>&lt;TextBlock Text="{Binding DisplayName}"
           Behaviors:DoubleClickEvent.AttachAction="Open($datacontext)" /&gt;
</code></pre>

<p>It will be a behavior that can be attached to any UI Element. In Action string we’re skipping specification of what event will be the Action attached to, because we are emulating one event – DoubleClick.</p>

<p>Attaching of the Action string to MouseLeftButtonUp is the tricky part. Mostly because to achieve that I had to modify declaration of one method in Caliburn.Micro for making it public. See <a href="https://hg01.codeplex.com/forks/vcaraulean/caliburnmicro/rev/ab06fc1697c7">this changeset</a> in my CM fork if you’re interested in details, but I’ll be asking CM’s authors to incorporate the change in main repository.</p>

<p>Attaching action string:</p>

<pre><code>private static void AttachActionToTarget(string text, DependencyObject d)
{
    var actionMessage = Parser.CreateMessage(d, text);

    var trigger = new ConditionalEventTrigger
    {
        EventName = "MouseLeftButtonUp",
        Condition = e =&gt; DoubleClickCatcher.IsDoubleClick(d, e)
    };
    trigger.Actions.Add(actionMessage);

    Interaction.GetTriggers(d).Add(trigger);
}
</code></pre>

<p>ConditionalEventTrigger is a small class that wraps EventTrigger and adding a condition that will be checked before raising event. If it’s false, event will not be raised. Snippet:</p>

<pre><code>public class ConditionalEventTrigger : EventTrigger
{
    public Func&lt;EventArgs, bool&gt; Condition { get; set; }

    protected override void OnEvent(EventArgs eventArgs)
    {
        if (Condition(eventArgs))
            base.OnEvent(eventArgs);
    }
}
</code></pre>

<p>I’ll not show here DoubleClickCatcher class because it’s not small, but you can find all related classes in <a href="https://gist.github.com/704830">this gist</a> on GitHub.</p>

<p>So far, I’m satisfied by this solution. Neat, simple and it works like a charm for us. I’ve used it with ListBox and DataGrid controls, but I think it should work on pretty any other visual element.</p>

<p><strong><a href="https://gist.github.com/704830">Complete source code</a>.</strong> Use with care. Any suggestions, remarks or bug reports are welcome.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Valeriu Caraulean</span></span>

      








  


<time datetime="2010-11-18T12:32:03+01:00" pubdate data-updated="true">Nov 18<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/silverlight/'>silverlight</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://caraulean.com/blog/2010/11/18/handling-mouse-double-click-event-in-silverlight-with-caliburn-micro/" data-via="vcaraulean" data-counturl="http://caraulean.com/blog/2010/11/18/handling-mouse-double-click-event-in-silverlight-with-caliburn-micro/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/2010/11/14/if-your-windows-phone-7-application-suddenly-stopped-working-in-emulator/" title="Previous Post: If your Windows Phone 7 application suddenly stopped working in emulator...">&laquo; If your Windows Phone 7 application suddenly stopped working in emulator...</a>
      
      
        <a class="basic-alignment right articlenav" href="/blog/2010/11/20/perceived-performance/" title="Next Post: Perceived performance">Perceived performance &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
	<h1>About</h1>
	<p>I'm a passionate software developer living in Geneva, Switzerland</p>
	<p><a href="/about">Read more ...</a></p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/14/book-review-nosql-distilled/">Book review - NoSQL Distilled</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/15/do-less-and-achieve-more-with-ravendb/">Do less and achieve more with RavenDb</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/09/diving-deeper-in-reactive-extensions/">Diving deeper in Reactive Extensions, concurrency</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/30/hello/">Hello, new blog!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/30/visual-studio-2012-dark-theme-tip/">Visual Studio 2012 dark theme tip - light up your UserControl in XAML designer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/28/evening-time-time-for-fun/">Evening time, time for fun</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/21/on-motivation-a-quote/">On motivation, a quote...</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/19/migrating-from-silverlight-to-wpf-a-case-study/">Migrating from Silverlight to WPF, a case study</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/18/fearing-about-silverlights-future-dont/">Fearing about Silverlight's future? Don't...</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/02/packed-for-vacation/">Packed for vacation...</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("vcaraulean", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/vcaraulean" class="twitter-follow-button" data-show-count="false">Follow @vcaraulean</a>
  
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/108353347632139121774?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Valeriu Caraulean -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'caraulean';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://caraulean.com/blog/2010/11/18/handling-mouse-double-click-event-in-silverlight-with-caliburn-micro/';
        var disqus_url = 'http://caraulean.com/blog/2010/11/18/handling-mouse-double-click-event-in-silverlight-with-caliburn-micro/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
